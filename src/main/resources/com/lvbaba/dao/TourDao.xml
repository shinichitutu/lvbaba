<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.lvbaba.dao.TourDao">
    <sql id="all">
        t_id,p_id,d_date,r_date,c_type,go_id,return_id,book_num,t_status
    </sql>
    <sql id="condition">
        <if test="tId!=null and tId!=''">t_id=#{tId}</if>
        <if test="pId!=null and pId!=''">p_id=#{pId}</if>
        <if test="dDate!=null and dDate!=''">
            d_date=#{dDate}
        </if>
        <if test="rDate!=null and rDate!=''">
            r_date=#{rDate}
        </if>
        <if test="cType!=null and cType!=''">
            c_type=#{cType}
        </if>
        <if test="goId!=null and goId!=''">
            go_id=#{goId}
        </if>
        <if test="returnId!=null and returnId!=''">
            return_id=#{returnId}
        </if>
        <if test="bookNum!=null and bookNum!=''">
            book_num=#{bookNum}
        </if>
        <if test="tStatus!=null and tStatus!=''">
            t_status=#{tStatus}
        </if>
    </sql>
    <update id="updateTour">
        UPDATE tour
        <set>
            <if test="pId!=null and pId!=''">p_id=#{pId},</if>
            <if test="dDate!=null and dDate!=''">
                d_date=#{dDate},
            </if>
            <if test="rDate!=null and rDate!=''">
                r_date=#{rDate},
            </if>
            <if test="cType!=null and cType!=''">
                c_type=#{cType},
            </if>
            <if test="goId!=null and goId!=''">
                go_id=#{goId},
            </if>
            <if test="returnId!=null and returnId!=''">
                return_id=#{returnId},
            </if>
            <if test="bookNum!=null and bookNum!=''">
                book_num=#{bookNum},
            </if>
            <if test="tStatus!=null and tStatus!=''">
                t_status=#{tStatus}
            </if>
        </set>
    </update>
    <delete id="removeTour">
        DELETE from tour where t_id=#{tId}
    </delete>
    <select id="query" resultMap="tourMap">
        SELECT <include refid="all"/>from tour
        <where>
            <include refid="condition"></include>
        </where>
    </select>
    <select id="queryAll" resultMap="tourMap">
        SELECT <include refid="all"/>FROM  tour
        <where>
            <include refid="condition"/>
        </where>
    </select>
    <select id="queryByPid" resultMap="tourMap">
        SELECT <include refid="all"/>FROM tour
        <where>
            <include refid="condition"/>
        </where>
    </select>
    <resultMap id="tourMap" type="Tour">
        <id property="tId" column="t_id"/>
        <result property="pId" column="p_id"/>
        <result property="dDate" column="d_date"/>
        <result property="rDate" column="r_date"/>
        <result property="cType" column="c_type"/>
        <result property="goId" column="go_id"/>
        <result property="returnId" column="return_id"/>
        <result property="bookNum" column="book_num"/>
        <result property="tStatus" column="t_status"/>
    </resultMap>
    <insert id="insertTour">
        insert INTO tour(p_id, d_date, r_date, c_type, go_id, return_id, book_num, t_status) VALUE
        (#{pId},#{dDate},#{rDate},#{cType},#{goId},#{returnId},#{bookNum},#${tStatus})
    </insert>
</mapper>